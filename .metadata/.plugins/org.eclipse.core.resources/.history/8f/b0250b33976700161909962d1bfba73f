#include "KDTree.h"
#include <assert.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "SPLogger.h"
#include "SPPoint.h"
#include "SPKDArray.c"
typedef struct sp_KDTree_Node {
	int Dim;
	int Val;
	SPPoint Data;
	struct sp_KDTree_Node* left;
	struct sp_KDTree_Node* right;
};

SPKDTreeNode buildKDTree(SPKDArray array, int depth){
	if(array->size == 0 || depth<0);
		return SP_KDTREE_INVALID_ARGUMENT;
	SPKDTreeNode kdtree= (SPKDTreeNode)malloc(sizeof(*kdtree));
	if(kdtree == NULL){
				return SP_KDTREE_OUT_OF_MEMORY;
			}
	if(array->size == 1){
		kdtree->Data = spPointCopy(array->pointArr[0]);
	}
	else 
	{
		int spread;
		int random;
		SPKDTreeNode left = (SPKDTreeNode)malloc(sizeof(*left));
		SPKDTreeNode right = (SPKDTreeNode)malloc(sizeof(*right));
		if(left == NULL || right ==NULL){
			free(left);
			free(right);
			return SP_KDTREE_OUT_OF_MEMORY;
		}
		if(depth%2==0){
			spread = array->pointArr[-1][0]-array->pointArr[0][0];
			random = rand()%spread;
			left,right = spKdarraySplit(array, l->data[0]);
			kdtree->Dim =l->data[0];
		
		}
		else{
			spread = array->pointArr[-1][1]-array->pointArr[1][0];
			random = rand()%spread;

			left,right = spKdarraySplit(array, l->data[1]);
			kdtree->Dim =l->data[1];
		}
		kdtree->left = buildKDTree(left, depth+1)
		kdtree->left = buildKDTree(right, depth+1)
		kdtree->Data = NULL;
		kdtree->Dim = spread;
	}
	return kdtree;
}
